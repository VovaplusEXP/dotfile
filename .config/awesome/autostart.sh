#!/bin/bash
# ═══════════════════════════════════════════════════════════════════════════
#  Скрипт автозапуска для AwesomeWM (Kali Linux Xfce стиль)
#  Автор: VovaplusEXP
#  Лицензия: MIT
# ═══════════════════════════════════════════════════════════════════════════

# Функция для запуска приложения только если оно ещё не запущено
run() {
    if ! pgrep -f "$1" > /dev/null; then
        "$@" &
    fi
}

# ═══════════════════════════════════════════════════════════════
# XFCE КОМПОНЕНТЫ
# ═══════════════════════════════════════════════════════════════

# xfdesktop - управление рабочим столом (иконки, обои, правый клик)
# Параметр --disable-wm-check отключает проверку оконного менеджера
run xfdesktop --disable-wm-check

# Thunar в режиме демона для быстрого открытия файлового менеджера
run thunar --daemon

# xfsettingsd - применение GTK тем и настроек Xfce
run xfsettingsd

# Управление питанием (важно для ноутбуков)
run xfce4-power-manager

# Демон уведомлений Xfce
run xfce4-notifyd

# ═══════════════════════════════════════════════════════════════
# СИСТЕМНЫЕ УТИЛИТЫ
# ═══════════════════════════════════════════════════════════════

# Compositor (picom) для прозрачности окон, теней и анимаций
# Параметр -b запускает в фоновом режиме
run picom -b

# Network Manager Applet - управление сетевыми подключениями
run nm-applet

# Bluetooth manager (опционально, раскомментируйте если нужно)
# run blueman-applet

# Polkit агент для запроса прав администратора в GUI
run /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1

# ═══════════════════════════════════════════════════════════════
# ПОЛЬЗОВАТЕЛЬСКИЕ ПРИЛОЖЕНИЯ
# ═══════════════════════════════════════════════════════════════

# Clipboard manager (опционально, раскомментируйте если нужно)
# run xfce4-clipman

# Установка обоев через feh (если не используется xfdesktop)
# Раскомментируйте если хотите использовать feh вместо xfdesktop
# feh --bg-scale ~/.config/awesome/wallpaper.jpg

# ═══════════════════════════════════════════════════════════════
# ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ ДЛЯ ТЁМНОЙ ТЕМЫ
# ═══════════════════════════════════════════════════════════════

export GTK_THEME=Kali-Dark
export GTK2_RC_FILES=~/.gtkrc-2.0

# Дополнительные переменные окружения для Qt приложений (опционально)
# export QT_QPA_PLATFORMTHEME=gtk2
# export QT_STYLE_OVERRIDE=gtk2
